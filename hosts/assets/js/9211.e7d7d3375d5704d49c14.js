"use strict";(self.webpackChunkrsas_web=self.webpackChunkrsas_web||[]).push([[9211],{35807:(e,a,d)=>{d.d(a,{k:()=>t});const t=(e,a=0)=>(100*e).toFixed(a)+"%"},80870:(e,a,d)=>{d.d(a,{Z:()=>f});var t=d(8081),l=d.n(t),n=d(23645),c=d.n(n)()(l());c.push([e.id,".vulnDetailList > p[data-v-d4d2aec8] {\n  display: flex;\n  margin-bottom: 0;\n  padding: 16px 24px;\n  font-size: 14px;\n  border-radius: 4px;\n  line-height: 22px;\n}\n.vulnDetailList > p > span[data-v-d4d2aec8]:first-child {\n  min-width: 200px;\n  font-weight: 500;\n}\n.vulnDetailList > p > span[data-v-d4d2aec8]:first-child::after {\n  content: ':';\n  margin: 0 2px;\n}\n",""]);const f=c},41144:(e,a,d)=>{d.d(a,{Z:()=>f});var t=d(8081),l=d.n(t),n=d(23645),c=d.n(n)()(l());c.push([e.id,"",""]);const f=c},70485:(e,a,d)=>{d.d(a,{Z:()=>f});var t=d(8081),l=d.n(t),n=d(23645),c=d.n(n)()(l());c.push([e.id,".extraFilter[data-v-f779a4b4] {\n  height: 22px;\n}\n.extraFilter > span[data-v-f779a4b4] {\n  margin-right: 8px;\n}\n.extraFilter .ant-checkbox-group[data-v-f779a4b4] {\n  margin-right: 16px;\n}\n.singleStyle[data-v-f779a4b4] {\n  border: 0;\n  box-shadow: unset;\n}\n",""]);const f=c},24070:(e,a,d)=>{d.d(a,{Z:()=>U});var t=d(66252),l=d(3577),n=d(2262),c=d(27379),f=d(39022),s=d(35807),u=d(61641),i=d(79414);const o=(0,t.aZ)({__name:"HostVulnList",props:{source:{default:"online"},dataSource:{},loading:{type:Boolean},totalVulnNum:{},exportTypeTemplate:{},taskTypeNum:{},view:{}},setup(e){const a=e,{t:d}=i.i18n.global,o=(0,u.Y)(),r=[{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe49340293485099548823015186b0fbb7ee49591b000d116aa6a6a92a"),dataIndex:"vuln_index",key:"vuln_index",width:"100px"},{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe4934029348509954882301511509b8e217bf6364ea92993a6778beff"),dataIndex:"i18n_name",key:"i18n_name"},{title:[16,32,48].includes(a.taskTypeNum)?d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe4934029348509954882301518cef77b923611957a0483d9f5367de9805332eb9197e46811ccba2e7383bad70"):d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe4934029348509954882301519d295f89a47d1377aa7eaf22e1a2fdc657c313dae58d33fe2bcef80cd76b4172"),dataIndex:"targetNum",key:"targetNum",width:"150px"},{title:[16,32,48].includes(a.taskTypeNum)?d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe4934029348509954882301510ea85bdd73b0f3721f7a1321a52ca13574b3594170ceb6b89ad7e95307ece4f0"):d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe49340293485099548823015183d6b721ee955b5ed7d0ef647f2cf518aa1fea3577aae19135a29ac2d12e5139"),dataIndex:"percent",key:"percent",width:"150px"},{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe49340293485099548823015169dd12932352de7e9f50acb66b386cfb"),dataIndex:"vuln_count",key:"vuln_count",width:"150px"}];return(e,u)=>{const i=(0,t.up)("a-table-summary-cell"),p=(0,t.up)("a-table-summary-row"),v=(0,t.up)("a-table");return(0,t.wg)(),(0,t.j4)(v,{columns:r,dataSource:a.dataSource,loading:a.loading,rowKey:"vul_id",pagination:!1,scroll:"single"===a.view&&{y:400},defaultExpandAllRows:"offline"===e.source&&a.exportTypeTemplate&&"html"!=a.exportTypeTemplate},{bodyCell:(0,t.w5)((({column:e,record:c,index:u})=>{var i;return["vuln_index"==e.key?((0,t.wg)(),(0,t.iD)(t.HY,{key:0},[(0,t.Uk)((0,l.zw)("online"===a.source?c.vuln_index:u+1),1)],64)):(0,t.kq)("v-if",!0),"i18n_name"==e.key?((0,t.wg)(),(0,t.iD)(t.HY,{key:1},[(0,t.Wm)(f.Z,{level:c.vuln_level,isStandard:""},null,8,["level"]),(0,t.Uk)(" "+(0,l.zw)(c.i18n_name)+(0,l.zw)(c.vul_confirmed&&1==(null===(i=(0,n.SU)(o).getPromCode)||void 0===i?void 0:i.vuln_verify)?(0,n.SU)(d)("onlineReport.verifiable"):""),1)],64)):(0,t.kq)("v-if",!0),"targetNum"==e.key?((0,t.wg)(),(0,t.iD)(t.HY,{key:2},[(0,t.Uk)((0,l.zw)(`${c.host_count} / ${c.hosts_count}`),1)],64)):(0,t.kq)("v-if",!0),"percent"==e.key?((0,t.wg)(),(0,t.iD)(t.HY,{key:3},[(0,t.Uk)((0,l.zw)(c.host_count/c.hosts_count>.994&&c.host_count/c.hosts_count<1?"99%":(0,n.SU)(s.k)(c.host_count/c.hosts_count)),1)],64)):(0,t.kq)("v-if",!0)]})),expandedRowRender:(0,t.w5)((({record:e})=>[(0,t.Wm)(c.Z,{paramsData:e,source:a.source,taskTypeNum:a.taskTypeNum,exportTypeTemplate:a.exportTypeTemplate},null,8,["paramsData","source","taskTypeNum","exportTypeTemplate"])])),summary:(0,t.w5)((()=>[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(i,{"col-span":5},{default:(0,t.w5)((()=>[(0,t.Uk)((0,l.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467ffa0b0bfe493402934850995488230151575144aa9c041ccc5ff02fb364469f6f")),1)])),_:1}),(0,t.Wm)(i,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,l.zw)(e.totalVulnNum),1)])),_:1})])),_:1})])),_:1},8,["dataSource","loading","scroll","defaultExpandAllRows"])}}});var r=d(93379),p=d.n(r),v=d(7795),b=d.n(v),m=d(90569),g=d.n(m),h=d(3565),_=d.n(h),w=d(19216),y=d.n(w),k=d(44589),x=d.n(k),S=d(80870),T={};T.styleTagTransform=x(),T.setAttributes=_(),T.insert=g().bind(null,"head"),T.domAPI=b(),T.insertStyleElement=y(),p()(S.Z,T),S.Z&&S.Z.locals&&S.Z.locals;const U=(0,d(83744).Z)(o,[["__scopeId","data-v-d4d2aec8"]])},79211:(e,a,d)=>{d.r(a),d.d(a,{default:()=>j});var t=d(66252),l=d(2262),n=(d(57658),d(3577)),c=d(24070),f=d(36513),s=d(61446),u=d(39022),i=d(5255),o=d(61641),r=d(24206);const p=["title"],v=["title"],b={class:"extraFilter"},m={class:"bolder_title"},g={key:0,class:"bolder_title"},_={key:1},w=(0,t.aZ)({__name:"VulnInfo",props:{params:{type:Object,default:()=>({})}},setup(e){const a=e,{t:d}=(0,r.QT)(),w=(0,o.Y)(),y=ref(["10","20","50","100","1000000"]),k=ref(["high","middle","low"]),x=ref([]),S=ref([]),T=ref({vulns_exp_completed:0,vulns_support_exp:0,high:0,low:0,middle:0,vulnsCount:0,vulns_count:0}),U=ref(!1),Z=ref(0),z=reactive({page:1,size:10,total:Z}),$=e=>d("custom.Total_entries",{total:e}),N=computed((()=>{let e=[];return unref(T).high>0&&e.push({label:D("high",`${d("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d7416bc316b4ff1cc9657b7b2942116491a")}${unref(T).high})`),value:"high"}),unref(T).middle>0&&e.push({label:D("middle",`${d("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d743ec4c945a60459620b0cd3a80c3ca17f")}${unref(T).middle})`),value:"middle"}),unref(T).low>0&&e.push({label:D("low",`${d("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d744fe1d20cd67684bf28201128bfc58e81")}${unref(T).low})`),value:"low"}),e})),L=computed((()=>{let e=0;return k.value.map((a=>{e+="high"===a?T.value.high:"middle"===a?T.value.middle:T.value.low})),e})),I=computed((()=>(0,i.sR)(a.params.taskType)));function D(e,a){return h("span",{},[h(u.Z,{level:e}),h("span",{style:{marginLeft:"4px"}},a)])}function C(e,a){P(e,a),z.page=e,z.size=a}async function P(e=z.page,d=z.size){U.value=!0;const{data:t}=await(0,f.Nk)({task_ids:a.params.task_ids,source:"online",page:e,size:"1000000"==d?0:d,filterVulnLevels:k.value.join(","),vul_category_id:a.params.categoryId||""},unref(I));U.value=!1;const{vulns_info:l,total:n}=t,{vuln_list:c,vuln_level_count:s}=null==l?void 0:l.vuln_distribution;S.value=c.map(((a,t)=>({...a,vuln_index:(e-1)*d+t+1,hosts_count:null==l?void 0:l.vuln_distribution.hosts_count}))),T.value=s,"single"===a.params.view&&(1==a.params.vulnLevel.length&&a.params.vulnLevel.includes("high")?(T.value.middle=0,T.value.low=0):1==a.params.vulnLevel.length&&a.params.vulnLevel.includes("middle")?(T.value.high=0,T.value.low=0):1==a.params.vulnLevel.length&&a.params.vulnLevel.includes("low")&&(T.value.middle=0,T.value.high=0),console.log(a.params.vulnLevel)),Z.value=n||0}function W(){if(0===k.value.length)return s.ZP.warning(d("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d74c3a5536aba1aecf56d7047749c3db5e5e5d3a3f15d0fe11aff33ff38d9d9458fa7e309a3b83085093932e56e77483687")),void(k.value=x.value);x.value=k.value,z.page=1,P()}return async function(){a.params.vulnLevel&&(k.value=a.params.vulnLevel),await P(),k.value=[],unref(T).high>0&&k.value.push("high"),unref(T).middle>0&&k.value.push("middle"),unref(T).low>0&&k.value.push("low"),x.value=k.value}(),(e,f)=>{const s=(0,t.up)("a-pagination"),u=(0,t.up)("a-checkbox-group"),i=(0,t.up)("a-card");return(0,t.wg)(),(0,t.j4)(i,{title:e.$t("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d749c1e916bc37238f4d03b2c1120193d2d"),bordered:!1,class:(0,n.C_)("single"===a.params.view?"singleStyle":"")},{extra:(0,t.w5)((()=>{var d,c;return[(0,t._)("div",b,[(0,t._)("span",m,(0,n.zw)(e.$t("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d740dfb4d2754af0f9701883534358bead93ab9d53e68b9719e15fe173a20c1258f")),1),(0,t.Wm)(u,{onChange:W,value:(0,l.SU)(k),"onUpdate:value":f[2]||(f[2]=e=>(0,l.dq)(k)?k.value=e:null),name:"checkboxgroup",options:(0,l.SU)(N)},null,8,["value","options"]),[16,32,48].includes(a.params.taskType)||1!=(null===(d=(0,l.SU)(w).getPromCode)||void 0===d?void 0:d.vuln_verify)?(0,t.kq)("v-if",!0):((0,t.wg)(),(0,t.iD)("span",g,(0,n.zw)(e.$t("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d742c2ede0579048cd09093342a609042e7")),1)),[16,32,48].includes(a.params.taskType)||1!=(null===(c=(0,l.SU)(w).getPromCode)||void 0===c?void 0:c.vuln_verify)?(0,t.kq)("v-if",!0):((0,t.wg)(),(0,t.iD)("span",_,(0,n.zw)(`[${(0,l.SU)(T).vulns_exp_completed}/${(0,l.SU)(T).vulns_support_exp}]`),1))])]})),default:(0,t.w5)((()=>[(0,t.Wm)(c.Z,{dataSource:(0,l.SU)(S),loading:(0,l.SU)(U),source:"online",taskTypeNum:a.params.taskType,view:a.params.view,totalVulnNum:(0,l.SU)(L)||0},null,8,["dataSource","loading","taskTypeNum","view","totalVulnNum"]),(0,t.Wm)(s,{style:{"margin-top":"16px","text-align":"right"},"page-size-options":(0,l.SU)(y),current:(0,l.SU)(z).page,"onUpdate:current":f[0]||(f[0]=e=>(0,l.SU)(z).page=e),pageSize:(0,l.SU)(z).size,"onUpdate:pageSize":f[1]||(f[1]=e=>(0,l.SU)(z).size=e),"show-size-changer":"",total:(0,l.SU)(z).total,showTotal:$,onChange:C},{buildOptionText:(0,t.w5)((a=>[["10","20","50","100"].includes(a.value)?((0,t.wg)(),(0,t.iD)("span",{key:0,title:`${a.value}${(0,l.SU)(d)("custom.per_page")}`},(0,n.zw)(`${a.value}${(0,l.SU)(d)("custom.per_page")}`),9,p)):((0,t.wg)(),(0,t.iD)("span",{key:1,title:e.$t("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d74e2ccb5d2d55fd36ec1fbbf031850f5ca")},(0,n.zw)(e.$t("4be5af0ac5cd0c42e68e3ce54dc90cffcddd27ae79ad65cab11d42e7fa4d3dff7dd647d3fe12c06ad31f9cf4ac9fa3203afb932b5e822d9602e3492133658d74e2ccb5d2d55fd36ec1fbbf031850f5ca")),9,v))])),_:1},8,["page-size-options","current","pageSize","total"])])),_:1},8,["title","class"])}}});var y=d(93379),k=d.n(y),x=d(7795),S=d.n(x),T=d(90569),U=d.n(T),Z=d(3565),z=d.n(Z),$=d(19216),N=d.n($),L=d(44589),I=d.n(L),D=d(70485),C={};C.styleTagTransform=I(),C.setAttributes=z(),C.insert=U().bind(null,"head"),C.domAPI=S(),C.insertStyleElement=N(),k()(D.Z,C),D.Z&&D.Z.locals&&D.Z.locals;var P=d(83744);const W=(0,P.Z)(w,[["__scopeId","data-v-f779a4b4"]]),q=(0,t.aZ)({__name:"SingleVulnInfoModal",props:{visible:{type:Boolean},curModalParams:{}},emits:["cancel"],setup(e,{emit:a}){const d=e,n=history.state.opt?JSON.parse(history.state.opt):{},c=computed((()=>d.visible)),f=computed((()=>({view:"single",categoryId:d.curModalParams.id,task_ids:n.task_id||n.selectTasks.map((e=>e.task_id)).join(",")||"",taskType:n.task_type,vulnLevel:"total"===d.curModalParams.type?["high","middle","low"]:[d.curModalParams.type]}))),s=()=>{a("cancel")};return(e,a)=>{const d=(0,t.up)("a-modal");return(0,t.wg)(),(0,t.j4)(d,{title:e.$t("a68595c99d93674665c126f168481901a6dfcb76e90fd02db01239af446bd5c5347f8570a4c853971de00f9c13353ec4dd539ef792ce84fe3ed7a5b5e3c5b33f4818af0c410959a4acd6cafc7af52e27"),visible:(0,l.SU)(c),"onUpdate:visible":a[0]||(a[0]=e=>(0,l.dq)(c)?c.value=e:null),width:1200,footer:!1,onCancel:s},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{params:(0,l.SU)(f)},null,8,["params"])])),_:1},8,["title","visible"])}}});var A=d(41144),V={};V.styleTagTransform=I(),V.setAttributes=z(),V.insert=U().bind(null,"head"),V.domAPI=S(),V.insertStyleElement=N(),k()(A.Z,V),A.Z&&A.Z.locals&&A.Z.locals;const j=(0,P.Z)(q,[["__scopeId","data-v-5925f286"]])}}]);