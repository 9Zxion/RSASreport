"use strict";(self.webpackChunkrsas_web=self.webpackChunkrsas_web||[]).push([[7767],{86895:(e,a,d)=>{d.d(a,{Z:()=>s});var l=d(8081),t=d.n(l),c=d(23645),n=d.n(c)()(t());n.push([e.id,".host-list-content .filter[data-v-29ee62c4] {\n  text-align: right;\n}\n.host-list-content .defect-nums-items[data-v-29ee62c4] {\n  display: inline-block;\n  min-width: 60px;\n}\n.host-list-content .table[data-v-29ee62c4] .ant-table-row.no-expand + .ant-table-expanded-row,\n.host-list-content .table[data-v-29ee62c4] .ant-table-row.no-expand .ant-table-row-expand-icon {\n  display: none;\n}\n",""]);const s=n},67767:(e,a,d)=>{d.r(a),d.d(a,{default:()=>N}),d(57658);var l=d(66252),t=d(3577),c=d(2262),n=d(81269),s=d(92534),i=d(22560),o=d(39022),f=d(82073),b=d(79414);const u={key:1,class:"host-list-content"},_={class:"filter"},v=["src"],h={class:"table"},r=["src"],p={key:1,class:"defect-nums"},m={class:"defect-nums-items"},w={class:"defect-nums-items"},g={class:"defect-nums-items"},k={class:"defect-nums-items"},x=(0,l.aZ)({__name:"AssetsCNodeRiskLevel",props:{paramsData:{},loading:{type:Boolean}},setup(e){const a=e,{t:d}=b.i18n.global,{createMessage:x}=(0,s.U)(),S=(0,c.iH)([]),I=(0,c.iH)([]),y=(0,c.iH)([{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c03af0077ea93ccb795d1dfe8ccac11427"),dataIndex:"hostname",width:200}]),Z=(0,l.Fl)((()=>{var e,l;return(()=>{const{product_type:e}=a.paramsData;"RSAS"==e&&y.value.push({title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0f97481b7ae74015e86b04617c0e5185df81824fcc65ed51e949002f46e695d3c"),dataIndex:"risk_config",width:200}),"RSAS"!=e&&"BVS"!=e||y.value.push({title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c01e2008d26c16cc42f94977e9b079d9d8"),dataIndex:"rsas_point",width:150}),"RSAS"!=e&&"BVS"!=e||y.value.push({title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c08de2c6285bf49095499728314d026c3e"),dataIndex:"according_point",width:150}),"RSAS"!=e&&"BVS"!=e||y.value.push({title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c060fb368266e9d2c30122e8f5469aa9e8"),dataIndex:"bvs_point",width:150}),y.value.push({title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0e47b63568a57b233f7affdb74dcf525a"),dataIndex:"total_point",width:150})})(),null!==(e=null===(l=a.paramsData)||void 0===l||null===(l=l.child_node_risk_level)||void 0===l||null===(l=l.hosts_info_list)||void 0===l?void 0:l.hosts_level_count)&&void 0!==e?e:[]})),z=(0,c.iH)("");(0,l.YP)(Z,(e=>{e.high>0&&(S.value.push({label:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0d380300df322712f6ff843d7e13c1ba6")+`[${e.high}]`,value:"host_risk_high",img:n.QO.high.icon.online}),I.value.push("host_risk_high")),e.middle>0&&(S.value.push({label:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c033dcc14346db8e2f244635b39a5b68ab")+`[${e.middle}]`,value:"host_risk_middle",img:n.QO.middle.icon.online}),I.value.push("host_risk_middle")),e.low>0&&(S.value.push({label:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0dfba348d681ff44bc8d1f9098bbdff79")+`[${e.low}]`,value:"host_risk_low",img:n.QO.low.icon.online}),I.value.push("host_risk_low")),e.safe>0&&(S.value.push({label:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c056903aa2bb53861152e6dc81b29410bc")+`[${e.safe}]`,value:"host_risk_safe",img:n.QO.safe.icon.online}),I.value.push("host_risk_safe")),1==I.value.length&&(z.value=I.value[0])}),{immediate:!0});const U=[{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c074fd606d832b7a12ac9b87dc810d3e02"),dataIndex:"name"},{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0eb0efa2b69f5aa64573ebf8d1bbc8024"),dataIndex:"class_field"},{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c01cb642d89978e930bd0033887ad56544"),dataIndex:"according_point"},{title:d("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c060fb368266e9d2c30122e8f5469aa9e8"),dataIndex:"bvs_point"}],D=(0,l.Fl)((()=>{var e;return((null===(e=a.paramsData)||void 0===e||null===(e=e.child_node_risk_level)||void 0===e||null===(e=e.hosts_info_list)||void 0===e?void 0:e.host_list)||[]).filter((e=>!!(I.value.includes("host_risk_safe")&&e.total_point<1&&e.total_point>=0||I.value.includes("host_risk_low")&&e.total_point>1&&e.total_point<=5||I.value.includes("host_risk_middle")&&e.total_point>5&&e.total_point<=8||I.value.includes("host_risk_high")&&e.total_point>8&&e.total_point<=10)))||[]})),A=e=>{console.log("riskLevel",I.value),1===e.length&&(z.value=e[0]),0===e.length&&(x.info("至少选择一种主机类别！"),I.value.push(z.value))};return(0,l.bv)((()=>{})),(e,d)=>{const s=(0,l.up)("NoData"),b=(0,l.up)("a-checkbox"),x=(0,l.up)("a-checkbox-group"),Z=(0,l.up)("a-space"),z=(0,l.up)("a-table");return 0!=D.value.length||a.loading?((0,l.wg)(),(0,l.iD)("div",u,[(0,l._)("div",_,[(0,l._)("span",null,(0,t.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0f09c5bbfc2b068e6a80d5b3765726864c4fe1e59f1e7bab098ef40f18a1ac7c0")),1),(0,l.Wm)(x,{value:I.value,"onUpdate:value":d[0]||(d[0]=e=>I.value=e),name:"riskLevel",onChange:A},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(S.value,(e=>((0,l.wg)(),(0,l.j4)(b,{value:e.value,key:e.value},{default:(0,l.w5)((()=>[(0,l._)("img",{src:e.img,width:"15"},null,8,v),(0,l.Uk)(" "+(0,t.zw)(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])]),(0,l._)("div",h,[(0,l.Wm)(f.Z,{columns:y.value,dataSource:D.value,pagination:!1,scroll:{},loading:a.loading,rowKey:"hostname",rowClassName:e=>e.template_list&&0===e.template_list.length||(0,c.SU)(i.Sf)(e.template_list)?"no-expand":null},{bodyCell:(0,l.w5)((({column:a,record:d})=>["hostname"===a.dataIndex?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("img",{src:(0,c.SU)(n.ez)(d.total_point),width:"15"},null,8,r),(0,l.Uk)(" "+(0,t.zw)(d.hostname),1)],64)):"risk_config"===a.dataIndex?((0,l.wg)(),(0,l.iD)("div",p,[(0,l.Wm)(Z,{size:25},{default:(0,l.w5)((()=>[(0,l._)("span",m,[(0,l.Uk)((0,t.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0f276932ada3c4415e6d4250faddb72833b1a4b8e638455b930e5046a82a34c0c3ee916f6b9f66f269239a039ecdad80"))+": ",1),(0,l._)("strong",null,(0,t.zw)(d.vuln_total),1)]),(0,l._)("span",w,[(0,l.Wm)(o.Z,{level:"high"}),(0,l.Uk)(" "+(0,t.zw)(d.vuln_high),1)]),(0,l._)("span",g,[(0,l.Wm)(o.Z,{level:"middle"}),(0,l.Uk)(" "+(0,t.zw)(d.vuln_middle),1)]),(0,l._)("span",k,[(0,l.Wm)(o.Z,{level:"low"}),(0,l.Uk)(" "+(0,t.zw)(d.vuln_low),1)])])),_:2},1024)])):(0,l.kq)("v-if",!0)])),expandedRowRender:(0,l.w5)((({record:e})=>[(0,l.Wm)(z,{columns:U,"data-source":e.template_list,pagination:!1},null,8,["data-source"])])),_:1},8,["columns","dataSource","loading","rowClassName"])])])):((0,l.wg)(),(0,l.j4)(s,{key:0}))}}});var S=d(93379),I=d.n(S),y=d(7795),Z=d.n(y),z=d(90569),U=d.n(z),D=d(3565),A=d.n(D),C=d(19216),R=d.n(C),W=d(44589),H=d.n(W),$=d(86895),B={};B.styleTagTransform=H(),B.setAttributes=A(),B.insert=U().bind(null,"head"),B.domAPI=Z(),B.insertStyleElement=R(),I()($.Z,B),$.Z&&$.Z.locals&&$.Z.locals;const N=(0,d(83744).Z)(x,[["__scopeId","data-v-29ee62c4"]])}}]);