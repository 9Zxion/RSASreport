"use strict";(self.webpackChunkrsas_web=self.webpackChunkrsas_web||[]).push([[9316],{81269:(e,a,n)=>{n.d(a,{QO:()=>p,ez:()=>u,ns:()=>f,wi:()=>k});var l=n(66195),d=n(57413),o=n(30359),t=n(47832),i=n(38950);const c=parseFloat("7"),r=parseFloat("5"),s=parseFloat("2"),p={high:{key:"host_risk_high",key2:"site_risk_high",key3:"host_risk_high",name:"非常危险",color:"A60000",icon:{online:l},icon_big:{}},middle:{key:"host_risk_middle",key2:"site_risk_middle",key3:"host_risk_middle",name:"比较危险",color:"F84F00",icon:{online:d},icon_big:{}},low:{key:"host_risk_low",key2:"site_risk_low",key3:"host_risk_low",name:"比较安全",color:"396DC3",icon:{online:o},icon_big:{}},safe:{key:"host_risk_safe",key2:"site_risk_safe",key3:"host_risk_safe",name:"非常安全",color:"2E9204",icon:{online:t},icon_big:{}},unknown:{key:"host_risk_unknown",key2:"site_risk_unknown",key3:"host_risk_unknown",name:"未知风险",color:"999999",icon:{online:i},icon_big:{}}};function f(e){try{if("-"==e)return"unknown";const a=parseFloat(e);return a>=c?"high":a>=r?"middle":a>=s?"low":"safe"}catch(e){return"unknown"}}function u(e,a="online"){const n=f(e);return a in p[n].icon?p[n].icon[a]:e}const k=e=>{let a="";return e>=0&&e<4?a="low":e>=4&&e<7?a="middle":e>=7&&e<=10&&(a="high"),a}},94828:(e,a,n)=>{n.d(a,{Z:()=>y});var l=n(8081),d=n.n(l),o=n(23645),t=n.n(o),i=n(61667),c=n.n(i),r=new URL(n(57332),n.b),s=new URL(n(61440),n.b),p=new URL(n(33040),n.b),f=new URL(n(33352),n.b),u=new URL(n(48219),n.b),k=t()(d()),w=c()(r),v=c()(s),g=c()(p),_=c()(f),b=c()(u);k.push([e.id,`\n.level-font,\n  .levelImg {\n    display: inline-block;\n    width: 22px;\n    height: 23px;\n    font-size: 12px;\n    text-align: center;\n    color: #fff;\n    line-height: 22px;\n    vertical-align: middle;\n}\n.level-font::after {\n    display: none;\n}\n.level-0 {\n    background: url(${w}) no-repeat;\n    background-size: cover;\n}\n.level-1 {\n    background: url(${v}) no-repeat;\n    background-size: cover;\n}\n.level-2 {\n    background: url(${g}) no-repeat;\n    background-size: cover;\n}\n.level-3 {\n    background: url(${_}) no-repeat;\n    background-size: cover;\n}\n.level-4 {\n    background: url(${b}) no-repeat;\n    background-size: cover;\n}\n.level-en-0 {\n    background: url(${w}) no-repeat;\n    background-size: cover;\n}\n.level-en-1 {\n    background: url(${v}) no-repeat;\n    background-size: cover;\n}\n.level-en-2 {\n    background: url(${g}) no-repeat;\n    background-size: cover;\n}\n.level-en-3 {\n    background: url(${_}) no-repeat;\n    background-size: cover;\n}\n.level-en-4 {\n    background: url(${b}) no-repeat;\n    background-size: cover;\n}\n`,""]);const y=k},84817:(e,a,n)=>{n.d(a,{Z:()=>i});var l=n(8081),d=n.n(l),o=n(23645),t=n.n(o)()(d());t.push([e.id,".vulnItem[data-v-151a1fce] {\n  display: flex;\n  margin-bottom: 0;\n  padding: 16px 24px;\n  font-size: 14px;\n  border-radius: 4px;\n  line-height: 22px;\n}\n.vulnItem > span[data-v-151a1fce]:first-child {\n  min-width: 200px;\n  font-weight: 500;\n}\n.vulnItem > span[data-v-151a1fce]:first-child::after {\n  content: ':';\n  margin: 0 2px;\n}\n",""]);const i=t},48293:(e,a,n)=>{n.r(a),n.d(a,{default:()=>T});var l=n(66252),d=n(3577),o=n(2262),t=n(49963),i=n(39022),c=n(31769),r=n(5255),s=n(79414);const p={key:2,style:{margin:"0","min-width":"300px","word-wrap":"break-word","word-break":"break-all"}},f={key:3,style:{"min-width":"300px","white-space":"pre-wrap","word-wrap":"break-word","word-break":"break-all"}},u={key:0},k={key:1},w=(0,l.aZ)({__name:"FlawInfoList",props:{source:{default:"online"},dataSource:{},loading:{type:Boolean},taskId:{},exportTypeTemplate:{}},emits:["select-change"],setup(e,{emit:a}){const n=e,{t:w}=s.i18n.global,v=(0,o.iH)({defect_detail:{},func_call_stack:{},example:{},solution:{}}),g=(0,l.Fl)((()=>{let e=[{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad55077cf01aeecabd4e90568b2c7432e7e478"),dataIndex:"flaw_index",key:"flaw_index",width:100},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507fb66c8be556f674506974d3301848696"),dataIndex:"defect_name",key:"defect_name",width:350},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad550738b1f592941903eac6fe90a8a87bd3f2"),dataIndex:"cwe_id",key:"cwe_id",width:120},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507853c7c9a55ebf89b2e8ea3b74bc13571"),dataIndex:"filename",key:"filename",width:150},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad550718e49011d5aa08d2d8c99aff6176e7b0"),dataIndex:"dangerous_code",key:"dangerous_code",width:700},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad550743a44201f2dd32eda7431015abf773a0"),dataIndex:"code_line",key:"code_line",width:150}];return"online"===n.source&&(e=[...e,{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad55070b8409c31aac183acd211f20180aa044"),dataIndex:"codeDetail",key:"codeDetail",width:100}]),e})),_=[{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507d1f98a1c32bdc4a11452251bc9dddc96"),key:"defect_detail",formatter:(e,a)=>{if(a.defect_detail_len>11&&"online"===n.source){const n=e.split("\n");return(0,l.h)("span",{},[(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(n.slice(0,11).join("\n"))),(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",display:v.value.defect_detail[a.id]?"":"none"}},(0,r.Uo)(n.slice(11).join("\n"))),(0,l.h)(c.Z,{type:"link",style:{display:v.value.defect_detail[a.id]?"none":"",color:"#5f96ea"},onClick:()=>{v.value.defect_detail[a.id]=!v.value.defect_detail[a.id]}},w("custom.expand")),(0,l.h)(c.Z,{type:"link",style:{display:v.value.defect_detail[a.id]?"":"none",color:"#5f96ea"},onClick:()=>{v.value.defect_detail[a.id]=!v.value.defect_detail[a.id]}},w("custom.collapse"))])}return(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(e))}},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507482f4d22a614eccf25e23451a8f51de5"),key:"func_call_stack",formatter:(e,a)=>{if(a.func_call_stack_len>11&&"online"===n.source){const n=e.split("\r\n");return(0,l.h)("span",{},[(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(n.slice(0,11).join("\r\n"))),(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",display:v.value.func_call_stack[a.id]?"":"none"}},(0,r.Uo)(n.slice(11).join("\r\n"))),(0,l.h)(c.Z,{type:"link",style:{display:v.value.func_call_stack[a.id]?"none":"",color:"#5f96ea"},onClick:()=>{v.value.func_call_stack[a.id]=!v.value.func_call_stack[a.id]}},w("custom.expand")),(0,l.h)(c.Z,{type:"link",style:{display:v.value.func_call_stack[a.id]?"":"none",color:"#5f96ea"},onClick:()=>{v.value.func_call_stack[a.id]=!v.value.func_call_stack[a.id]}},w("custom.collapse"))])}return(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(e))}},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507b7d6c9ce244867cf89db53e9476ba3c9"),key:"example",formatter:(e,a)=>{if(a.example_len>11&&"online"===n.source){const n=e.split("\r\n");return(0,l.h)("span",{},[(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(n.slice(0,11).join("\r\n"))),(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",display:v.value.example[a.id]?"":"none"}},(0,r.Uo)(n.slice(11).join("\r\n"))),(0,l.h)(c.Z,{type:"link",style:{display:v.value.example[a.id]?"none":"",color:"#5f96ea"},onClick:()=>{v.value.example[a.id]=!v.value.example[a.id]}},w("custom.expand")),(0,l.h)(c.Z,{type:"link",style:{display:v.value.example[a.id]?"":"none",color:"#5f96ea"},onClick:()=>{v.value.example[a.id]=!v.value.example[a.id]}},w("custom.collapse"))])}return(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(e))}},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507a19df0690d458e5632e4e8a1c10a62d1"),key:"solution",formatter:(e,a)=>{if(a.solution_len>11&&"online"===n.source){const n=e.split("\r\n");return(0,l.h)("span",{},[(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(n.slice(0,11).join("\r\n"))),(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word",display:v.value.solution[a.id]?"":"none"}},(0,r.Uo)(n.slice(11).join("\r\n"))),(0,l.h)(c.Z,{type:"link",style:{display:v.value.solution[a.id]?"none":"",color:"#5f96ea"},onClick:()=>{v.value.solution[a.id]=!v.value.solution[a.id]}},w("custom.expand")),(0,l.h)(c.Z,{type:"link",style:{display:v.value.solution[a.id]?"":"none",color:"#5f96ea"},onClick:()=>{v.value.solution[a.id]=!v.value.solution[a.id]}},w("custom.collapse"))])}return(0,l.h)("pre",{style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},(0,r.Uo)(e))}},{title:w("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad5507576f9e17d0ef920d4e80526517fe69df2cca5fe3e8e56226953877ca147395da"),key:"refer_link",formatter:e=>(0,l.h)("a",{target:"_blank",href:e},e)}],b={onChange:e=>{a("select-change",e)}};return(e,a)=>{const c=(0,l.up)("a-button"),s=(0,l.up)("a-table");return(0,l.wg)(),(0,l.j4)(s,{columns:g.value,dataSource:n.dataSource,loading:n.loading,rowKey:"id","row-selection":"offline"!=e.source&&b,pagination:!1,defaultExpandAllRows:"offline"===e.source&&n.exportTypeTemplate&&"html"!=n.exportTypeTemplate},{bodyCell:(0,l.w5)((({column:a,record:t,index:s})=>["flaw_index"==a.key?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)((0,d.zw)("online"==e.source?t.flaw_index:s+1),1)],64)):(0,l.kq)("v-if",!0),"defect_name"==a.key?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Wm)(i.Z,{level:t.riskLevel,isStandard:""},null,8,["level"]),(0,l.Uk)(" "+(0,d.zw)(t.defect_name),1)],64)):(0,l.kq)("v-if",!0),"filename"==a.key?((0,l.wg)(),(0,l.iD)("p",p,(0,d.zw)(t.filename),1)):(0,l.kq)("v-if",!0),"dangerous_code"==a.key?((0,l.wg)(),(0,l.iD)("pre",f,(0,d.zw)((0,o.SU)(r.Uo)(t.dangerous_code)),1)):(0,l.kq)("v-if",!0),"codeDetail"==a.key?((0,l.wg)(),(0,l.j4)(c,{key:4,type:"link",onClick:e=>async function(e){window.open(`${window.origin}/#/codeDetail?taskId=${n.taskId}&num=${e.code_line}&filename=${e.filename}`,"_blank")}(t)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,d.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6bdc33feb8d6436d4731d62da9ad550764b3099a0cd984d7699fbbb6b41dd760")),1)])),_:2},1032,["onClick"])):(0,l.kq)("v-if",!0)])),expandedRowRender:(0,l.w5)((({record:e})=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(_,((a,n)=>(0,l.wy)((0,l._)("div",{class:"vulnItem",key:n,style:(0,d.j5)({background:n%2==0?"#fff":"#f7f8fa"})},[(0,l._)("span",null,(0,d.zw)(a.title),1),"object"==typeof a.formatter(e[a.key],e)?((0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.formatter(e[a.key],e))))])):((0,l.wg)(),(0,l.iD)("span",k,(0,d.zw)(a.formatter(e[a.key],e)),1))],4),[[t.F8,void 0!==e[a.key]&&""!==e[a.key]]]))),64))])),_:1},8,["columns","dataSource","loading","row-selection","defaultExpandAllRows"])}}});var v=n(93379),g=n.n(v),_=n(7795),b=n.n(_),y=n(90569),m=n.n(y),h=n(3565),x=n.n(h),I=n(19216),D=n.n(I),S=n(44589),Z=n.n(S),U=n(84817),z={};z.styleTagTransform=Z(),z.setAttributes=x(),z.insert=m().bind(null,"head"),z.domAPI=b(),z.insertStyleElement=D(),g()(U.Z,z),U.Z&&U.Z.locals&&U.Z.locals;const C=(0,n(83744).Z)(w,[["__scopeId","data-v-151a1fce"]]),T=(0,l.aZ)({__name:"FlawInfoList",props:{source:{default:"offline"},paramsData:{},loading:{type:Boolean},taskId:{},exportTypeTemplate:{}},setup(e){const a=e;return(e,n)=>((0,l.wg)(),(0,l.j4)(C,{source:a.source,dataSource:a.paramsData.defectList,loading:!1,exportTypeTemplate:a.exportTypeTemplate},null,8,["source","dataSource","exportTypeTemplate"]))}})},39022:(e,a,n)=>{n.d(a,{Z:()=>Q}),n(21703);var l=n(66252),d=n(2262),o=n(33352),t=n(33040),i=n(61440),c=n(57332),r=n(48219);const s=n.p+"assets/not_zh_9258be18ef2e5ab183d5.svg",p=n.p+"assets/high_en_ea3b2e3e05b08d8721c8.svg",f=n.p+"assets/mid_en_91b8613d3cde2ad34603.svg",u=n.p+"assets/low_en_c8c8d037a8cc39cb231c.svg",k=n.p+"assets/safe_en_f2165b1ab86561c7e39d.svg",w=n.p+"assets/danger_en_3c91fdb40407d21e9875.svg",v=n.p+"assets/not_en_92eaed31cd4ab58e734a.svg";var g=n(22560),_=n(45743),b=n(31641),y=n(81269),m=n(79414);const h={key:0,src:o,class:"levelImg",alt:""},x={key:1,src:t,class:"levelImg",alt:""},I={key:2,src:i,class:"levelImg",alt:""},D={key:3,src:c,class:"levelImg",alt:""},S={key:4,src:r,class:"levelImg",alt:""},Z={key:5,src:s,class:"levelImg",alt:""},U={key:0,src:p,class:"levelImg",alt:""},z={key:1,src:f,class:"levelImg",alt:""},C={key:2,src:u,class:"levelImg",alt:""},T={key:3,src:k,class:"levelImg",alt:""},q={key:4,src:w,class:"levelImg",alt:""},j={key:5,src:v,class:"levelImg",alt:""},$=(0,l.aZ)({__name:"SecurityLevel",props:{level:{}},setup(e){const a=e,{t:n}=m.i18n.global,{getLocale:o}=(0,_.b)();let t=(0,d.iH)("level-1");const i=(0,d.iH)("low"),c=e=>{"low"===e?t.value=(0,d.SU)(o)===b.M.ZH_CN?"level-1":"level-en-1":"middle"===e?t.value=(0,d.SU)(o)===b.M.ZH_CN?"level-2":"level-en-3":"high"===e?t.value=(0,d.SU)(o)===b.M.ZH_CN?"level-3":"level-en-3":new Error("level is not in [low, middle, high]")};return(0,l.YP)((()=>a.level),(e=>{(0,g.HD)(e)?(c(e),i.value=e):(0,g.hj)(e)?(c((0,y.wi)(e)),i.value=(0,y.wi)(e)):(0,g.Sf)(e)&&(c("low"),i.value="low")}),{immediate:!0}),(e,a)=>(0,d.SU)(o)===(0,d.SU)(b.M).ZH_CN?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},["high"==i.value?((0,l.wg)(),(0,l.iD)("img",h)):(0,l.kq)("v-if",!0),"middle"==i.value?((0,l.wg)(),(0,l.iD)("img",x)):(0,l.kq)("v-if",!0),"low"==i.value?((0,l.wg)(),(0,l.iD)("img",I)):(0,l.kq)("v-if",!0),"safe"==i.value?((0,l.wg)(),(0,l.iD)("img",D)):(0,l.kq)("v-if",!0),"danger"==i.value?((0,l.wg)(),(0,l.iD)("img",S)):(0,l.kq)("v-if",!0),""==i.value?((0,l.wg)(),(0,l.iD)("img",Z)):(0,l.kq)("v-if",!0)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},["high"==i.value?((0,l.wg)(),(0,l.iD)("img",U)):(0,l.kq)("v-if",!0),"middle"==i.value?((0,l.wg)(),(0,l.iD)("img",z)):(0,l.kq)("v-if",!0),"low"==i.value?((0,l.wg)(),(0,l.iD)("img",C)):(0,l.kq)("v-if",!0),"safe"==i.value?((0,l.wg)(),(0,l.iD)("img",T)):(0,l.kq)("v-if",!0),"danger"==i.value?((0,l.wg)(),(0,l.iD)("img",q)):(0,l.kq)("v-if",!0),""==i.value?((0,l.wg)(),(0,l.iD)("img",j)):(0,l.kq)("v-if",!0)],64))}});var H=n(93379),L=n.n(H),W=n(7795),F=n.n(W),R=n(90569),A=n.n(R),E=n(3565),Y=n.n(E),M=n(19216),N=n.n(M),P=n(44589),B=n.n(P),K=n(94828),O={};O.styleTagTransform=B(),O.setAttributes=Y(),O.insert=A().bind(null,"head"),O.domAPI=F(),O.insertStyleElement=N(),L()(K.Z,O),K.Z&&K.Z.locals&&K.Z.locals;const Q=$},48219:(e,a,n)=>{e.exports=n.p+"assets/danger_zh_3c91fdb40407d21e9875.svg"},33352:(e,a,n)=>{e.exports=n.p+"assets/high_zh_1e2c0d6af4f17f191916.svg"},61440:(e,a,n)=>{e.exports=n.p+"assets/low_zh_07ca5242b49942161aea.svg"},33040:(e,a,n)=>{e.exports=n.p+"assets/mid_zh_6816e87698475a75c083.svg"},57332:(e,a,n)=>{e.exports=n.p+"assets/safe_zh_0efe2a7d718ca7bae96c.svg"},57413:(e,a,n)=>{e.exports=n.p+"assets/moredangerousIcon@2x_902888fd1164dce735ba.png"},30359:(e,a,n)=>{e.exports=n.p+"assets/saferIcon@2x_f89e9812ca5a66554480.svg"},38950:(e,a,n)=>{e.exports=n.p+"assets/unknownRisk_6de08e4d07acb26dacb1.svg"},66195:(e,a,n)=>{e.exports=n.p+"assets/verydangerousIcon@2x_98fd37c9396a0b7ac651.png"},47832:(e,a,n)=>{e.exports=n.p+"assets/verysaferIcon@2x_e577d03e2cd68c3f522c.png"}}]);