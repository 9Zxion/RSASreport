"use strict";(self.webpackChunkrsas_web=self.webpackChunkrsas_web||[]).push([[6127],{30274:(e,a,d)=>{d.d(a,{Z:()=>n});var c=d(8081),f=d.n(c),t=d(23645),l=d.n(t)()(f());l.push([e.id,".filter_content[data-v-4e2deb85] {\n  display: flex;\n  justify-content: space-between;\n  align-items: end;\n  margin-bottom: 20px;\n}\n.filter_content .risk[data-v-4e2deb85] {\n  margin-left: 8px;\n}\n.filter_content .vulnFilter[data-v-4e2deb85] {\n  margin-top: 4px;\n}\n.filter_content .vulnFilter span[data-v-4e2deb85]:first-child {\n  margin-right: 10px;\n}\n.vulnItem .title[data-v-4e2deb85] {\n  line-height: 32px;\n  display: inline-block;\n  margin: 0 8px;\n  cursor: pointer;\n}\n.vulnItem .title > span[data-v-4e2deb85]:first-child {\n  margin: 0 2px;\n}\n.vulnItem .title > span.nop[data-v-4e2deb85],\n.vulnItem .title.nop[data-v-4e2deb85] {\n  cursor: text;\n}\n.vulnItem .title .anticon[data-v-4e2deb85] {\n  margin: 0 2px;\n}\n.vulnItem .title img[data-v-4e2deb85] {\n  width: 15px;\n  vertical-align: middle;\n}\n.vulnItem .detail .detail_wrap[data-v-4e2deb85] {\n  margin: 8px 0;\n  padding: 16px 12px;\n  border: dashed 1px #dee0e3;\n}\n.vulnItem .detail .detail_wrap span[data-v-4e2deb85] {\n  display: block;\n  line-height: 24px;\n}\n.vulnItem .detail .detail_wrap:first-child pre[data-v-4e2deb85] {\n  margin-bottom: 0;\n}\n",""]);const n=l},28484:(e,a,d)=>{d.d(a,{Z:()=>n});var c=d(8081),f=d.n(c),t=d(23645),l=d.n(t)()(f());l.push([e.id,".filter_content[data-v-115aa057] {\n  display: flex;\n  justify-content: space-between;\n  align-items: end;\n  margin-bottom: 20px;\n}\n.filter_content .risk[data-v-115aa057] {\n  margin-left: 8px;\n}\n.filter_content .right_summary[data-v-115aa057] {\n  display: flex;\n  gap: 16px;\n}\n.vuln-process[data-v-115aa057] {\n  display: flex;\n  align-items: center;\n  margin: 16px 0;\n  width: 500px;\n}\n.vuln-process span[data-v-115aa057]:first-child {\n  white-space: nowrap;\n}\n.vuln-process span[data-v-115aa057]:last-child {\n  margin-left: 12px;\n  font-size: 12px;\n  white-space: nowrap;\n  color: #aaa;\n  line-height: 22px;\n}\n.vulnItem > div.vulnItembox[data-v-115aa057] {\n  display: flex;\n  align-items: baseline;\n}\n.vulnItem .title[data-v-115aa057] {\n  line-height: 32px;\n  display: inline-block;\n  margin: 0 8px;\n  cursor: pointer;\n}\n.vulnItem .title > span[data-v-115aa057]:first-child {\n  margin: 0 2px;\n}\n.vulnItem .title > span.nop[data-v-115aa057],\n.vulnItem .title.nop[data-v-115aa057] {\n  cursor: text;\n}\n.vulnItem .title .anticon[data-v-115aa057] {\n  margin: 0 2px;\n}\n.vulnItem .title img[data-v-115aa057] {\n  margin: 0 2px 4px;\n  width: 14px;\n}\n.vulnItem .detail .detail_wrap[data-v-115aa057] {\n  margin: 8px 0;\n  padding: 16px 12px;\n  border: dashed 1px #dee0e3;\n}\n.vulnItem .detail .detail_wrap pre[data-v-115aa057] {\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n.vulnItem .detail .vuln_wrap span[data-v-115aa057] {\n  display: block;\n  line-height: 24px;\n}\n.vulnItem .detail .detail_wrap:first-child pre[data-v-115aa057] {\n  margin-bottom: 0;\n}\n.vulnItem .detail .detail_wrap:last-child span[data-v-115aa057]:first-child {\n  margin-right: 16px;\n  font-weight: 500;\n  color: #535353;\n}\n.category_title[data-v-115aa057] {\n  margin: 12px 0;\n}\n[data-v-115aa057] .ant-table-tbody > tr > td {\n  vertical-align: top;\n}\n",""]);const n=l},95208:(e,a,d)=>{d.d(a,{Z:()=>n});var c=d(8081),f=d.n(c),t=d(23645),l=d.n(t)()(f());l.push([e.id,".filter_content[data-v-13fe7f0c] {\n  display: flex;\n  justify-content: end;\n  margin-bottom: 20px;\n}\n.filter_content .risk[data-v-13fe7f0c] {\n  margin-left: 8px;\n}\n.filter_content .vulnFilter[data-v-13fe7f0c] {\n  margin-top: 4px;\n}\n.filter_content .vulnFilter span[data-v-13fe7f0c]:first-child {\n  margin-right: 10px;\n}\n.vulnItem .title[data-v-13fe7f0c] {\n  line-height: 32px;\n  display: inline-block;\n  margin: 0 8px;\n  cursor: pointer;\n}\n.vulnItem .title > span[data-v-13fe7f0c]:first-child {\n  margin: 0 2px;\n}\n.vulnItem .title .anticon[data-v-13fe7f0c] {\n  margin: 0 2px;\n}\n.vulnItem .title img[data-v-13fe7f0c] {\n  width: 15px;\n  vertical-align: middle;\n}\n.vulnItem .detail .detail_wrap[data-v-13fe7f0c] {\n  margin: 8px 0;\n  padding: 16px 12px;\n  border: dashed 1px #dee0e3;\n}\n.vulnItem .detail .detail_wrap pre[data-v-13fe7f0c] {\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n.vulnItem .detail .detail_wrap:first-child pre[data-v-13fe7f0c] {\n  margin-bottom: 0;\n}\n.vulnItem .detail .detail_wrap:last-child span[data-v-13fe7f0c]:first-child {\n  margin-right: 16px;\n  font-weight: 500;\n  color: #535353;\n}\n[data-v-13fe7f0c] .ant-table-tbody > tr > td {\n  vertical-align: top;\n}\n",""]);const n=l},3145:(e,a,d)=>{d.d(a,{Z:()=>n});var c=d(8081),f=d.n(c),t=d(23645),l=d.n(t)()(f());l.push([e.id,"",""]);const n=l},26127:(e,a,d)=>{d.r(a),d.d(a,{default:()=>Fe});var c=d(66252),f=(d(57658),d(3577)),t=d(49963),l=d(2262),n=d(49081),i=d(80782),b=d(61446),s=d(76856),o=d(25091),r=d(92534),u=d(23775),v=d(39022),p=d(5255),m=d(24206);const _={class:"filter_content"},w={class:"right_summary"},k={class:"risk"},g={class:"risk"},y={class:"risk"},h={key:0},x={key:0,class:"vuln-process"},$={key:0},C={class:"category_title bolder_title"},z={class:"vulnItembox"},T=["onClick"],D=["title"],I=["title"],U={key:0},Z={key:1},S={class:"detail"},H={key:0,class:"detail_wrap"},W={key:1,class:"detail_wrap vuln_wrap"},q={key:2,class:"detail_wrap"},P={key:1},E={key:1,class:"category_title bolder_title"},A={key:0,class:"vulnItem"},j={class:"title"},F=["onClick"],O={class:"detail"},L={key:0,class:"detail_wrap"},V={key:1,class:"detail_wrap"},Y=(0,c.aZ)({__name:"HostVulnOverviewComp",props:{paramsData:{},source:{},exportTypeTemplate:{},wrap:{}},setup(e){const a=e,{t:Y}=(0,m.QT)(),M=(0,u.g)(),B=(0,l.iH)(),K=(0,c.Fl)((()=>[{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ed4fafa6d3b160176234621333ff1b00d"),dataIndex:"port",key:"port",width:200},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ec21d322c3c7b02d1edaad82223bb40b2"),dataIndex:"protocol",key:"protocol",width:200},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e42a25cc5a2bcfde54115aa0fe72ae513"),dataIndex:"service",key:"service",width:200},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8180cdf2945728b77a1fe9501595e7c2"),dataIndex:"verify",key:"verify"},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8e5fa00ee8fe1f9c3f1d3e5ffe8cf9b1ada0d5ebc8973b39759fbf2dd855ec2f"),dataIndex:"nfs",key:"nfs",width:150}])),R=[{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8180cdf2945728b77a1fe9501595e7c2"),dataIndex:"verify",key:"verify"},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e2458593381f8f6926a0e0d2d638f6297fb0e0d7d6e46e6d0fcc042d1f5681e25"),dataIndex:"software",key:"software"},{title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ed36ab5a3d618c6cf9cfd0113dea619e86327b6b952b3ad49a20ddc7e201ce3ee"),dataIndex:"version",key:"version"}],N=(0,l.iH)({}),Q=(0,l.iH)({}),G=(0,l.iH)({});"online"==a.source&&Promise.all([d.e(2861),d.e(4011)]).then(d.bind(d,14011)).then((e=>{B.value=e.default}));const J=(0,c.Fl)((()=>a.paramsData.is_vuln_verify)),X=(0,l.iH)([]),ee=(0,l.iH)([]),ae=(0,l.iH)({}),de=(0,l.iH)({}),ce=(0,l.iH)({}),fe=(0,c.Fl)((()=>{if(X.value){let e=(0,p.p$)(X.value);return(0,l.SU)(le)?e.filter((e=>(e.vuls=e.vuls.filter((e=>e.vul_confirmed)),e.vuls.length>0))):e}return[]})),te=(0,c.Fl)((()=>{let e={vulnHighCount:0,vulnMiddleCount:0,vulnLowCount:0,isExpSupportedCount:0};for(let a in(0,l.SU)(X))(0,l.SU)(X)[a].vuls.forEach((a=>{"high"===a.vul_level?e.vulnHighCount++:"middle"===a.vul_level?e.vulnMiddleCount++:e.vulnLowCount++,a.vul_confirmed&&e.isExpSupportedCount++}));for(let a in(0,l.SU)(ee))"high"===(0,l.SU)(ee)[a].vul_level?e.vulnHighCount++:"middle"===(0,l.SU)(ee)[a].vul_level?e.vulnMiddleCount++:e.vulnLowCount++;return e})),le=(0,l.iH)(!1),ne=(0,l.iH)(!1),ie=(0,l.iH)(!1),be=(0,l.iH)(!1);let se=(0,l.iH)({});const oe=(0,l.iH)(0),re=(0,l.iH)(!1),ue=(0,l.iH)(0);let ve,pe;const me=location.href.includes("reportOnline")?location.href.split("reportOnline/")[1].split("/"):[];function _e(e){"remote"===e?fe.value.map((e=>{var a;null===(a=e.vuls)||void 0===a||a.map((e=>{N.value[e.scan_vuls_id]=(0,l.SU)(ne)}))})):ee.value.map((e=>{Q.value[e.vul_id]=(0,l.SU)(ie)}))}function we(e){const a=document.getElementById(e.toString()),d=document.getElementsByClassName("report_wrap")[0];if(a){const c=a.getBoundingClientRect().top+(null==d?void 0:d.scrollTop)-45;null==d||d.scrollTo({top:c,behavior:"smooth"}),M.setCurExpandVulnId(e)}}function ke(){let e=[];console.log(ae.value),console.log(N.value);for(let a in N.value)if(N.value[a]&&e.push(a),!ae.value[a]&&N.value[a])return void b.ZP.warning(Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e53a638ce943f20f8affecaa77bc74e85ff03f130e718fea700576d6c04bb03ed8dd68ac2eae6a1cb182dfed1e64c7e6becb64056b49af543021cd1b6f5a36a4612a7554fad81737d5c30672a02178c8a455db16dec3c5ec0891ee97afd5d383aa149f1e54c2c67bbdabd12080e3e2c4df4ea70cccbdd242265348e925892e9c6"));0!==e.length?(0,r.Z)({iconType:"info",title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e6c6dd2140d7e01009a7e143757f5d6f3"),content:Y("onlineReport.vulnCheckMsg"),onOk:async()=>{const{batchExpAttackApi:a,getWarningInfoApi:c,getExpAttackProcessApi:f}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83));ve=f;const{data:t}=await c({expType:"all"});if("success"==t.status){const{data:d}=await a({task_id:me[1],scan_vuls_id:e.join(","),batch:"yes",exp_task_type:"host"});console.log(d),"success"==d.status?(re.value=!0,ye("no")):"fail"==d.status?b.ZP.error(d.message):b.ZP.error(Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e082b358c402e5a160d090e05d12cf018b0b27045a402bb56d892a6aa5db0bc4b"))}else b.ZP.error(t.exp_type_warn_info||Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e163311a18e6e26b53b08dba2fbc3c3168230c72d67817959835af9892d942242b9f54143211fcd6e4f89f46e49683ed991b773f4bdc7bc35c906a86d99f181f7"))}}):b.ZP.warning(Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e39b69caa145a766ea3c1f1abeb3b88f890c1ab4be6322fd79cae82afc706f8aa"))}function ge({key:e}){let a=[];for(let e in N.value)N.value[e]&&a.push([ce.value[e],de.value[e]]);for(let e in Q.value)Q.value[e]&&a.push([e,"-"]);a.length>0?(0,r.Z)({iconType:"info",title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e6c6dd2140d7e01009a7e143757f5d6f3"),content:`${Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8d8174b55ad459edf85ff8a013654956b5ab0011b860f9f767cae7b052036ddbbe7e15492b1ff79e5896d82f7c48939e")}${Y("fix-ip"===e?"a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e95e935fdc5b9ce6adc75ebd83689dbb0cb125a97eb73ae27ff62fdf81d99c61e8339bfb9acdfd06a1757925a2bb4c8bbd5e0808b081f7198b523159355e16281247a5cee3285ed77517643c85ea5f7f7":"a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e95e935fdc5b9ce6adc75ebd83689dbb0bb862a81657605bea4690a885ed2c75a56ecc2a0f8fbb316b51263ebdf486be5773acd4cbecaee73abce2e66763f0b94")}`,onOk:async()=>{const{correctVulApi:c}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:f}=await c({task_id:me[1],task_ip:me[2],vul_ids:a,type:e});200===f.code&&"s"===f.data.msg?location.reload():b.ZP.error(f.message||Y("修正失败"))}}):b.ZP.warning(Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e39b69caa145a766ea3c1f1abeb3b88f890c1ab4be6322fd79cae82afc706f8aa"))}async function ye(e){if(!ve){const{getExpAttackProcessApi:e}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83));ve=e}const{data:c}=await ve({task_id:me[1],task_ip_id:a.paramsData.task_ip_id,first:e});"running"==c.status?(re.value=!0,oe.value=c.process_num,pe=setTimeout((()=>{ye()}),4e3)):"finished"==c.status&&("yes"==c.first||e||(re.value=!1,b.ZP.success(Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eee9579014c4ef92fd8557b72885afd7e9a4b1d5ca9904ca6ff3ac687064ae4b8f0804f350e742b293a86a679d9ae50c7d1616e91c1cf1aba8a1405b7354da093"))))}function he(e,a){(0,r.Z)({iconType:"warning",title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e6c6dd2140d7e01009a7e143757f5d6f3"),content:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8d8174b55ad459edf85ff8a013654956f4d958838d177d89c89c81051da411ea8faf2e0d0ee2cf7ec75bd5ce2062dd6ae3b4ed5748633352f19671e2ea2b6af3a412de12f20b38d39de9432a6f6c035986751d8ca6e9d3b7cdbf6653fb686c18"),onOk:async()=>{const{correctVulApi:c}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:f}=await c({task_id:me[1],task_ip:me[2],vul_ids:[[e.vul_id.toString(),e.port]],type:"fix-ip"});200===f.code&&"s"===f.data.msg?$e(e,a):b.ZP.error(f.message||Y("修正失败"))}})}function xe(e,a){(0,r.Z)({iconType:"warning",title:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e6c6dd2140d7e01009a7e143757f5d6f3"),content:Y("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8d8174b55ad459edf85ff8a013654956f4d958838d177d89c89c81051da411ea8faf2e0d0ee2cf7ec75bd5ce2062dd6a633ecf9f477b54e1603c96185d65eee102b2cf12c3dcd0e75d689362273a48cf"),onOk:async()=>{const{correctVulApi:c}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:f}=await c({task_id:me[1],task_ip:me[2],vul_ids:[[e.vul_id.toString(),e.port]],type:"fix-task"});200===f.code&&"s"===f.data.msg?$e(e,a):b.ZP.error(f.message||Y("修正失败"))}})}function $e(e,a){if("remote"===a)for(let a in(0,l.SU)(X)){const d=(0,l.SU)(X)[a].vuls;d.some(((a,c)=>{if(a.id===e.id)return d.splice(c,1),!1}))}else for(let a in(0,l.SU)(ee))if(ee.value[a].id===e.id)return ee.value.splice(a,1),!1}function Ce(){setTimeout((()=>{ye("yes")}),100)}return(0,c.YP)((()=>le),(()=>{ne.value=!1,N.value={}}),{deep:!0}),(0,c.YP)((()=>a.paramsData),(()=>{X.value=(0,p.p$)(a.paramsData.vul_info.vul_items.filter((e=>{if("0"!==e.protocol)return e.vuls.length&&e.vuls.map((e=>{de.value[e.scan_vuls_id]=e.port,ce.value[e.scan_vuls_id]=e.vul_id,e.vul_confirmed&&(ae.value[e.scan_vuls_id]=!0)})),e}))),ee.value=(0,p.p$)(a.paramsData.login_vul_info.vul_items),"online"===a.source&&J.value&&ye("yes")}),{immediate:!0}),(0,c.Jd)((()=>{pe&&clearTimeout(pe)})),(e,b)=>{var r,u,p;const m=(0,c.up)("a-button"),M=(0,c.up)("a-menu-item"),X=(0,c.up)("a-menu"),ae=(0,c.up)("DownOutlined"),de=(0,c.up)("a-dropdown"),ce=(0,c.up)("a-checkbox"),ve=(0,c.up)("a-progress"),pe=(0,c.up)("a-table");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",_,[(0,c._)("div",null,["offline"!=a.source&&J.value&&"assets"!=a.wrap?((0,c.wg)(),(0,c.j4)(m,{key:0,type:"primary",size:"small",onClick:ke},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e58cece87294affa649c8253015d2a191d53d2d36ad3d33220ea9267f3cf05a81")),1)])),_:1})):(0,c.kq)("v-if",!0),"offline"!=a.source&&"assets"!=a.wrap?((0,c.wg)(),(0,c.j4)(de,{key:1},{overlay:(0,c.w5)((()=>[(0,c.Wm)(X,{onClick:ge},{default:(0,c.w5)((()=>[(0,c.Wm)(M,{key:"fix-ip"},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb3364e49867fea94c8148133a2f87bab2")),1)])),_:1}),(0,c.Wm)(M,{key:"fix-task"},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb0c596e64a8b59ca5dd9389794b33539a")),1)])),_:1})])),_:1})])),default:(0,c.w5)((()=>[(0,c.Wm)(m,{type:"primary",size:"small"},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ef6ea6fe3ffe053571409ed51e9a2c164ba17d5c312b07471cffef08622316448"))+" ",1),(0,c.Wm)(ae)])),_:1})])),_:1})):(0,c.kq)("v-if",!0)]),(0,c._)("div",w,[(0,c._)("div",null,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e3d322c98b665b3166a5775a5f79319776f013bb52e1081dd7d535a4d53e91897")),1),(0,c._)("span",k,[(0,c.Wm)(v.Z,{level:"high"}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e6dd34fd277e731fe198aa73180fd53f51579c135c694e477d9061435e7cdbf1a"))+" "+(0,f.zw)(`(${null===(r=te.value)||void 0===r?void 0:r.vulnHighCount})`),1)]),(0,c._)("span",g,[(0,c.Wm)(v.Z,{level:"middle"}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e2753384d59d2bf03b602fdc08a120c10a98e6dc684461deca23d1c2cba8da601"))+" "+(0,f.zw)(`(${null===(u=te.value)||void 0===u?void 0:u.vulnMiddleCount})`),1)]),(0,c._)("span",y,[(0,c.Wm)(v.Z,{level:"low"}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e85d424b8d860cd3151522068c1f7587443915ea0a58eaf740dba044e68be6156"))+" "+(0,f.zw)(`(${null===(p=te.value)||void 0===p?void 0:p.vulnLowCount})`),1)])]),J.value&&"assets"!=a.wrap?((0,c.wg)(),(0,c.iD)("div",h,[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e958d63df74cffd7569b87da904fa7d0d2027b84892f45210f969a6ac6f5bb4d9"))+" ",1),(0,c._)("span",null,[(0,c.Wm)(ce,{checked:le.value,"onUpdate:checked":b[0]||(b[0]=e=>le.value=e)},{default:(0,c.w5)((()=>{var a;return[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e067b4d572a40d56b6f9532d28e1f3d2cc6d4ab89374662b71aac751332f9ed46"))+(0,f.zw)(`[${null===(a=te.value)||void 0===a?void 0:a.isExpSupportedCount}]`),1)]})),_:1},8,["checked"])])])):(0,c.kq)("v-if",!0)])]),J.value&&re.value?((0,c.wg)(),(0,c.iD)("div",x,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e958d63df74cffd7569b87da904fa7d0dd861829c486b1b43d47dfb3e81301b0e")),1),(0,c.Wm)(ve,{status:"active",strokeWidth:15,percent:oe.value},null,8,["percent"]),100==oe.value?((0,c.wg)(),(0,c.iD)("span",$,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eee9579014c4ef92fd8557b72885afd7e9a4b1d5ca9904ca6ff3ac687064ae4b8f0804f350e742b293a86a679d9ae50c7d1616e91c1cf1aba8a1405b7354da093")),1)):(0,c.kq)("v-if",!0)])):(0,c.kq)("v-if",!0),(0,c._)("p",C,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e463d9dc20018103311372eb9e80208613aadbdbaa89d46221d4b6d081dd523a7")),1),(0,c.Wm)(pe,{columns:K.value,dataSource:fe.value,pagination:!1},{headerCell:(0,c.w5)((({column:d})=>["verify"==d.key&&"assets"!=a.wrap?((0,c.wg)(),(0,c.j4)(ce,{key:0,onChange:b[1]||(b[1]=e=>_e("remote")),checked:ne.value,"onUpdate:checked":b[2]||(b[2]=e=>ne.value=e)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8180cdf2945728b77a1fe9501595e7c2")),1)])),_:1},8,["checked"])):(0,c.kq)("v-if",!0)])),bodyCell:(0,c.w5)((({column:b,record:r})=>["verify"==b.key?((0,c.wg)(!0),(0,c.iD)(c.HY,{key:0},(0,c.Ko)(r.vuls,(b=>((0,c.wg)(),(0,c.iD)("div",{class:"vulnItem",key:b.id},[(0,c._)("div",z,[(0,c.wy)((0,c.Wm)(ce,{checked:N.value[b.scan_vuls_id],"onUpdate:checked":e=>N.value[b.scan_vuls_id]=e},null,8,["checked","onUpdate:checked"]),[[t.F8,"assets"!=a.wrap]]),(0,c._)("div",{class:(0,f.C_)(["title",{nop:"assets"==a.wrap}])},[(0,c.Wm)(v.Z,{level:b.vul_level},null,8,["level"]),(0,c._)("span",{class:(0,f.C_)({nop:"assets"==a.wrap}),onClick:e=>we(b.vul_id)},(0,f.zw)(`${b.vul_msg.i18n_name}${J.value&&b.vul_confirmed?`【${(0,l.SU)(Y)("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e067b4d572a40d56b6f9532d28e1f3d2cc6d4ab89374662b71aac751332f9ed46")}】`:""}`),11,T),"pdf"!=a.exportTypeTemplate?((0,c.wg)(),(0,c.j4)((0,l.SU)(s.Z),{key:0,title:e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e94981cb9bd296297f6887fba099f102d8cbe5244478655ddda49d4a285ffb9f4"),onClick:e=>G.value[`${r.port}_${r.protocol}_${b.vul_id}`]=!G.value[`${r.port}_${r.protocol}_${b.vul_id}`]},null,8,["title","onClick"])):(0,c.kq)("v-if",!0),J.value&&b.vul_confirmed&&"pdf"!=a.exportTypeTemplate&&"assets"!=a.wrap?((0,c.wg)(),(0,c.j4)((0,l.SU)(o.Z),{key:1,title:e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e1c7b59ad2e75277c4b63d453b13c7e69adf1b9ee380933eded6bc4a2ab0b4a17"),onClick:e=>async function(e){ue.value++;const{getSysatkApi:a}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:c}=await a({task_id:me[1],scan_vuls_id:e.scan_vuls_id});se.value=c,be.value=!0}(b)},null,8,["title","onClick"])):(0,c.kq)("v-if",!0),J.value&&"1"==b.has_result?((0,c.wg)(),(0,c.iD)("img",{key:2,title:e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eced47f935a1c3c69613b303856ef7c30e5b9b1e42afbc509efaa70cbddebec3d2e97e846f5150e11900a27895f298c4a"),src:n},null,8,D)):(0,c.kq)("v-if",!0),J.value&&"0"==b.has_result?((0,c.wg)(),(0,c.iD)("img",{key:3,title:b.result||e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eee9579014c4ef92fd8557b72885afd7e04e64edb9d93270bf81899c4e8c0a8f4"),src:i},null,8,I)):(0,c.kq)("v-if",!0),"offline"==a.source&&"pdf"==a.exportTypeTemplate?((0,c.wg)(),(0,c.iD)(c.HY,{key:4},[J.value&&"1"==b.has_result?((0,c.wg)(),(0,c.iD)("span",U," 【"+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eced47f935a1c3c69613b303856ef7c30e5b9b1e42afbc509efaa70cbddebec3d2e97e846f5150e11900a27895f298c4a"))+"】 ",1)):(0,c.kq)("v-if",!0),J.value&&"0"==b.has_result?((0,c.wg)(),(0,c.iD)("span",Z," 【 "+(0,f.zw)(b.result||e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eee9579014c4ef92fd8557b72885afd7e04e64edb9d93270bf81899c4e8c0a8f4"))+" 】 ",1)):(0,c.kq)("v-if",!0)],64)):(0,c.kq)("v-if",!0)],2)]),(0,c.wy)((0,c._)("div",S,[b.mess_string?((0,c.wg)(),(0,c.iD)("div",H,[(0,c._)("pre",null,(0,f.zw)(b.mess_string.join("\n")),1)])):(0,c.kq)("v-if",!0),J.value&&b.has_result&&[0,1].includes(b.has_result)&&b.vul_confirmed?((0,c.wg)(),(0,c.iD)("div",W,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e958d63df74cffd7569b87da904fa7d0d2027b84892f45210f969a6ac6f5bb4d9")),1),(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5eee9579014c4ef92fd8557b72885afd7ec989bf39a7303a9d01fcb5c8391f88a0"))+(0,f.zw)(b.exp_value),1),(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e695f4308fb52aa4e53ece3a4becf9616bfabee8c1cf4be6f944cc5af25b8e289"))+(0,f.zw)(b.proof),1)])):(0,c.kq)("v-if",!0),"online"==a.source&&"assets"!=a.wrap?((0,c.wg)(),(0,c.iD)("div",q,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e3ec86653f4ff1e56e7c188cb949c25ef52a8c2c24234be6012da058270e8913b")),1),(0,c.Wm)(m,{type:"primary",size:"small",onClick:e=>he(b,"remote")},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb3364e49867fea94c8148133a2f87bab2")),1)])),_:2},1032,["onClick"]),(0,c.Wm)(m,{type:"primary",size:"small",onClick:e=>xe(b,"remote")},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb0c596e64a8b59ca5dd9389794b33539a")),1)])),_:2},1032,["onClick"])])):(0,c.kq)("v-if",!0)],512),[[t.F8,G.value[`${r.port}_${r.protocol}_${b.vul_id}`]||"pdf"==a.exportTypeTemplate]])])))),128)):(0,c.kq)("v-if",!0),"nfs"==b.key?((0,c.wg)(),(0,c.iD)("ul",P,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(r.vuls,(e=>((0,c.wg)(),(0,c.iD)("li",{style:{"line-height":"32px"},key:e.id},(0,f.zw)(e.if_defend),1)))),128))])):(0,c.kq)("v-if",!0)])),_:1},8,["columns","dataSource"]),ee.value&&ee.value.length>0?((0,c.wg)(),(0,c.iD)("p",E,(0,f.zw)((0,l.SU)(Y)("onlineReport.localScan")),1)):(0,c.kq)("v-if",!0),ee.value&&ee.value.length>0?((0,c.wg)(),(0,c.j4)(pe,{key:2,columns:R,dataSource:ee.value,pagination:!1},{headerCell:(0,c.w5)((({column:a})=>["verify"==a.key?((0,c.wg)(),(0,c.j4)(ce,{key:0,onChange:b[3]||(b[3]=e=>_e("local")),checked:ie.value,"onUpdate:checked":b[4]||(b[4]=e=>ie.value=e)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e8180cdf2945728b77a1fe9501595e7c2")),1)])),_:1},8,["checked"])):(0,c.kq)("v-if",!0)])),bodyCell:(0,c.w5)((({column:d,record:n})=>["verify"==d.key?((0,c.wg)(),(0,c.iD)("div",A,[(0,c._)("div",null,[(0,c.Wm)(ce,{checked:Q.value[n.vul_id],"onUpdate:checked":e=>Q.value[n.vul_id]=e},null,8,["checked","onUpdate:checked"]),(0,c._)("div",j,[(0,c.Wm)(v.Z,{level:n.vul_level},null,8,["level"]),(0,c._)("span",{onClick:e=>we(n.vul_id)},(0,f.zw)(n.vul_msg.i18n_name),9,F),(0,c.Wm)((0,l.SU)(s.Z),{title:e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e94981cb9bd296297f6887fba099f102d8cbe5244478655ddda49d4a285ffb9f4"),onClick:e=>G.value[n.vul_id]=!G.value[n.vul_id]},null,8,["title","onClick"])])]),(0,c.wy)((0,c._)("div",O,[n.mess_string?((0,c.wg)(),(0,c.iD)("div",L,[(0,c._)("pre",null,(0,f.zw)(n.mess_string.join("\n")),1)])):(0,c.kq)("v-if",!0),"online"==a.source?((0,c.wg)(),(0,c.iD)("div",V,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5e3ec86653f4ff1e56e7c188cb949c25ef52a8c2c24234be6012da058270e8913b")),1),(0,c.Wm)(m,{type:"primary",size:"small",onClick:e=>he(n,"local")},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb3364e49867fea94c8148133a2f87bab2")),1)])),_:2},1032,["onClick"]),(0,c.Wm)(m,{type:"primary",size:"small",onClick:e=>xe(n,"local")},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f6751c10c19043eb917bdd930ea6d4d5ebc368a5c11819c06fbb64e5f556330bb0c596e64a8b59ca5dd9389794b33539a")),1)])),_:2},1032,["onClick"])])):(0,c.kq)("v-if",!0)],512),[[t.F8,G.value[n.vul_id]||"pdf"==a.exportTypeTemplate]])])):(0,c.kq)("v-if",!0),"software"==d.key?((0,c.wg)(!0),(0,c.iD)(c.HY,{key:1},(0,c.Ko)(n.vul_soft_list,((e,a)=>((0,c.wg)(),(0,c.iD)("p",{key:a},(0,f.zw)(e.software),1)))),128)):(0,c.kq)("v-if",!0),"version"==d.key?((0,c.wg)(!0),(0,c.iD)(c.HY,{key:2},(0,c.Ko)(n.vul_soft_list,((e,a)=>((0,c.wg)(),(0,c.iD)("p",{key:a},(0,f.zw)(e.version),1)))),128)):(0,c.kq)("v-if",!0)])),_:1},8,["dataSource"])):(0,c.kq)("v-if",!0),"offline"!=a.source?((0,c.wg)(),(0,c.j4)((0,c.LL)(B.value),{visible:be.value,key:ue.value,type:"host",onCancel:b[5]||(b[5]=e=>be.value=!1),onGetProcess:Ce,paramsData:(0,l.SU)(se)},null,40,["visible","paramsData"])):(0,c.kq)("v-if",!0)],64)}}});var M=d(93379),B=d.n(M),K=d(7795),R=d.n(K),N=d(90569),Q=d.n(N),G=d(3565),J=d.n(G),X=d(19216),ee=d.n(X),ae=d(44589),de=d.n(ae),ce=d(28484),fe={};fe.styleTagTransform=de(),fe.setAttributes=J(),fe.insert=Q().bind(null,"head"),fe.domAPI=R(),fe.insertStyleElement=ee(),B()(ce.Z,fe),ce.Z&&ce.Z.locals&&ce.Z.locals;var te=d(83744);const le=(0,te.Z)(Y,[["__scopeId","data-v-115aa057"]]),ne={class:"filter_content"},ie={class:"risk"},be={class:"risk"},se={class:"risk"},oe={class:"title"},re=["onClick"],ue={class:"detail"},ve={key:0,class:"detail_wrap"},pe={key:1,class:"detail_wrap"},me=(0,c.aZ)({__name:"ImageVulnOverviewComp",props:{paramsData:{},source:{},wrap:{}},setup(e){const a=e,{t:n}=(0,m.QT)(),i=(0,u.g)(),o=(0,c.Fl)((()=>[{title:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939df6555e1f744a9e9ece128ddaaf6738b93f735804a293ed2c33594dfd9a4a827"),dataIndex:"software",key:"software"},{title:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939df6555e1f744a9e9ece128ddaaf6738b597eeb382452b31e3d8d000efe1d8271"),dataIndex:"version",key:"version"},{title:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939d6dcc1e8fde112cd99de16b15f7dd1f5214c60920162986fcb79b5d9a2e22b8d"),dataIndex:"vuls",key:"vuls"}])),_=(0,l.iH)([]),w=location.href.includes("reportOnline")?location.href.split("reportOnline/")[1].split("/"):[],k=(0,l.iH)({}),g=(0,c.Fl)((()=>(0,l.SU)(_))),y=(0,c.Fl)((()=>{let e={vulnHighCount:0,vulnMiddleCount:0,vulnLowCount:0};for(let a in(0,l.SU)(g))(0,l.SU)(g)[a].vuls.forEach((a=>{"high"===a.vul_level?e.vulnHighCount++:"middle"===a.vul_level?e.vulnMiddleCount++:e.vulnLowCount++}));return e}));function h(e){for(let a in(0,l.SU)(_)){const d=(0,l.SU)(_)[a].vuls;d.some(((a,c)=>{if(a.id===e.id)return d.splice(c,1),!1}))}}return(0,c.YP)((()=>a.paramsData),(()=>{_.value=(0,p.p$)(a.paramsData.vul_items)}),{immediate:!0}),(e,u)=>{var p,m,_;const x=(0,c.up)("a-button"),$=(0,c.up)("a-table");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",ne,[(0,c._)("div",null,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939d6dcc1e8fde112cd99de16b15f7dd1f545cf1f9f08ccacdace821e55d4ae8e50")),1),(0,c._)("span",ie,[(0,c.Wm)(v.Z,{level:"high",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939e976c55907a415791435f3228ebfb09f1f429f9ba487e2c189b267ccad5388e0"))+" "+(0,f.zw)(`[${null===(p=y.value)||void 0===p?void 0:p.vulnHighCount}]`),1)]),(0,c._)("span",be,[(0,c.Wm)(v.Z,{level:"middle",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939af4ec5964d8e87c2949e6913a76a89a076b7ace5d400e5b4d66933e63cda7fd9"))+" "+(0,f.zw)(`[${null===(m=y.value)||void 0===m?void 0:m.vulnMiddleCount}]`),1)]),(0,c._)("span",se,[(0,c.Wm)(v.Z,{level:"low",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f49397e4c001276b4069acd7716a1955bceaf988d1ce3d1328282efc6d75380d83047"))+" "+(0,f.zw)(`[${null===(_=y.value)||void 0===_?void 0:_.vulnLowCount}]`),1)])])]),(0,c.Wm)($,{columns:o.value,dataSource:g.value,pagination:!1},{bodyCell:(0,c.w5)((({column:o,record:u})=>["vuls"==o.key?((0,c.wg)(!0),(0,c.iD)(c.HY,{key:0},(0,c.Ko)(u.vuls,(o=>((0,c.wg)(),(0,c.iD)("div",{class:"vulnItem",key:o.id},[(0,c._)("div",null,[(0,c._)("div",oe,[(0,c.Wm)(v.Z,{level:o.vul_level,isStandard:""},null,8,["level"]),(0,c._)("span",{onClick:e=>function(e){const a=document.getElementById(e.toString()),d=document.getElementsByClassName("report_wrap")[0];if(a){const c=a.getBoundingClientRect().top+d.scrollTop-45;d.scrollTo({top:c,behavior:"smooth"}),i.setCurExpandVulnId(e)}}(o.vul_id)},(0,f.zw)(`${o.vul_msg.i18n_name}`),9,re),(0,c.Wm)((0,l.SU)(s.Z),{onClick:e=>k.value[`${u.software}_${u.version}_${o.vul_id}`]=!k.value[`${u.software}_${u.version}_${o.vul_id}`]},null,8,["onClick"])])]),(0,c.wy)((0,c._)("div",ue,[o.mess_string?((0,c.wg)(),(0,c.iD)("div",ve,[(0,c._)("pre",null,(0,f.zw)(o.mess_string[0]),1)])):(0,c.kq)("v-if",!0),"online"==a.source&&"assets"!=a.wrap?((0,c.wg)(),(0,c.iD)("div",pe,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939cb6d806e70fd4d42f193c80b90e484c2a8a42bdad4d2b36b771aef598d696ff8")),1),(0,c.Wm)(x,{type:"primary",size:"small",onClick:e=>function(e){(0,r.Z)({iconType:"warning",title:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f49394b403555abd1f2bb70803fa746b791b35b9d3879da00b532604696f4a9aaf453"),content:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f49391b4596ca821d3c8bccb9c265038ea25530d555b10e810c4afa0b594d8948a3cfcca04a4156e61af6bc5d2975ff55d407873260ebc33cb559459720abb992a3e08a376185a8f3adddd6ee69ec460d04ad9893574289ef022be87c5d4373cf2649"),onOk:async()=>{const{correctImageVulApi:a}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:c}=await a({task_id:w[1],task_ip:w[2],vul_id:e.vul_id,port:e.port,type:"fix-ip"});200===c.code&&"s"===c.data.msg?h(e):b.ZP.error(c.message||n("修正失败"))}})}(o)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939005fdadd1a40ae039414a1d48861c48b2d6fb05dc936cd08d7254fd551770d34")),1)])),_:2},1032,["onClick"]),(0,c.Wm)(x,{type:"primary",size:"small",onClick:e=>function(e){(0,r.Z)({iconType:"warning",title:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f49394b403555abd1f2bb70803fa746b791b35b9d3879da00b532604696f4a9aaf453"),content:n("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f49391b4596ca821d3c8bccb9c265038ea25530d555b10e810c4afa0b594d8948a3cfcca04a4156e61af6bc5d2975ff55d4079b34cf9a6d3be685f4e418da3b247e6e7dfc595aaabf3843a5f7cbc8302cffdd"),onOk:async()=>{const{correctImageVulApi:a}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:c}=await a({task_id:w[1],task_ip:w[2],vul_id:e.vul_id,port:e.port,type:"fix-task"});200===c.code&&"s"===c.data.msg?h(e):b.ZP.error(c.message||n("修正失败"))}})}(o)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467f0ef5b0430f7a78a44f427b90b63f4939005fdadd1a40ae039414a1d48861c48b1fd61914d2f450d3b5a03d2a9cd17454")),1)])),_:2},1032,["onClick"])])):(0,c.kq)("v-if",!0)],512),[[t.F8,k.value[`${u.software}_${u.version}_${o.vul_id}`]]])])))),128)):(0,c.kq)("v-if",!0)])),_:1},8,["columns","dataSource"])],64)}}});var _e=d(95208),we={};we.styleTagTransform=de(),we.setAttributes=J(),we.insert=Q().bind(null,"head"),we.domAPI=R(),we.insertStyleElement=ee(),B()(_e.Z,we),_e.Z&&_e.Z.locals&&_e.Z.locals;const ke=(0,te.Z)(me,[["__scopeId","data-v-13fe7f0c"]]);var ge=d(82786),ye=d(79414);const he={class:"filter_content"},xe=(e=>((0,c.dD)("data-v-4e2deb85"),e=e(),(0,c.Cn)(),e))((()=>(0,c._)("div",null,null,-1))),$e={class:"risk"},Ce={class:"risk"},ze={class:"risk"},Te=["title"],De={class:"detail"},Ie={key:0,class:"detail_wrap"},Ue={key:1,class:"detail_wrap"},Ze={key:2,class:"detail_wrap"},Se=(0,c.aZ)({__name:"HistoryTaskVulnOverviewComp",props:{paramsData:{},isHistry:{type:Boolean},source:{},wrap:{}},setup(e){const a=e,{t:i}=ye.i18n.global,b=(0,c.Fl)((()=>[{title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f17f2ee8128fa1387aee8486256c206f0"),dataIndex:"port",key:"port"},{title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f58b18e8da4f6fea4ed3e1b66d66b32f0"),dataIndex:"protocol",key:"protocol"},{title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f456a7688514252087ffd79309227b632"),dataIndex:"service",key:"service"},{title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f1c07138b8cb467aaab5f5cba7189a374"),dataIndex:"verify",key:"verify"},{title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f049fc2600cbdcb6722fb7fae186dc16d"),dataIndex:"nfs",key:"nfs"}]));(0,l.iH)({});const o=(0,l.iH)([]),u=((0,l.iH)({}),(0,l.iH)({})),m=(0,c.Fl)((()=>{if(o.value){let e=(0,p.p$)(o.value);return(0,l.SU)(w)?e.filter((e=>(e.vuls=e.vuls.filter((e=>e.vul_confirmed)),e.vuls.length>0))):e}return[]})),_=(0,c.Fl)((()=>{let e={vulnHighCount:0,vulnMiddleCount:0,vulnLowCount:0,isExpSupportedCount:0};for(let a in(0,l.SU)(m))(0,l.SU)(m)[a].vuls.forEach((a=>{"high"===a.vulnLevel||"high"==a.vul_level?e.vulnHighCount++:"middle"===a.vulnLevel||"middle"==a.vul_level?e.vulnMiddleCount++:e.vulnLowCount++,a.vul_confirmed&&e.isExpSupportedCount++}));return e})),w=(0,l.iH)(!1);return(0,l.iH)(!1),(0,c.YP)((()=>(0,l.SU)(a.paramsData)),(()=>{o.value=(0,p.p$)((0,l.SU)(a.paramsData).vul_info||[])}),{immediate:!0}),(e,p)=>{var w,k,g;const y=(0,c.up)("a-button"),h=(0,c.up)("a-table");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",he,[xe,(0,c._)("div",null,[(0,c._)("div",null,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f78aa063de21d4d2a9cb20b5a0832646e")),1),(0,c._)("span",$e,[(0,c.Wm)(v.Z,{level:"high",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3fea70bce4f00e75359a1f187a3b064690"))+" "+(0,f.zw)(`[${null===(w=_.value)||void 0===w?void 0:w.vulnHighCount}]`),1)]),(0,c._)("span",Ce,[(0,c.Wm)(v.Z,{level:"middle",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f6874001b6ddefbba5436e2c5493a34f9"))+" "+(0,f.zw)(`[${null===(k=_.value)||void 0===k?void 0:k.vulnMiddleCount}]`),1)]),(0,c._)("span",ze,[(0,c.Wm)(v.Z,{level:"low",isStandard:""}),(0,c.Uk)(" "+(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f1ef6567e80e9759356314cc6ec1217c7"))+" "+(0,f.zw)(`[${null===(g=_.value)||void 0===g?void 0:g.vulnLowCount}]`),1)])])])]),(0,c.Wm)(h,{columns:b.value,dataSource:m.value,pagination:!1},{bodyCell:(0,c.w5)((({column:b,record:p})=>["verify"==b.key?((0,c.wg)(!0),(0,c.iD)(c.HY,{key:0},(0,c.Ko)(p.vuls,(b=>((0,c.wg)(),(0,c.iD)("div",{class:"vulnItem",key:b.id},[(0,c._)("div",null,[(0,c._)("div",{class:(0,f.C_)(["title",{nop:"assets"==a.wrap}])},[(0,c.Wm)(v.Z,{level:b.vulnLevel||b.vul_level,isStandard:""},null,8,["level"]),(0,c._)("span",{class:(0,f.C_)({nop:"assets"==a.wrap})},(0,f.zw)(`${b.vul_msg.i18n_name}${b.isExpSupported?`【${e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3ffd7875a8acd49d1fb216a8f97daace59")}】`:""}`),3),(0,c.Wm)((0,l.SU)(s.Z),{onClick:e=>u.value[`${p.port}_${p.protocol}_${b.vul_id}`]=!u.value[`${p.port}_${p.protocol}_${b.vul_id}`]},null,8,["onClick"]),"1"==b.vulnExpHasResult?((0,c.wg)(),(0,c.iD)("img",{key:0,title:e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f70a4941930bc8757acd5fd754ad6c1232ca924c76948b1ce48454f91871f4fed"),src:n},null,8,Te)):(0,c.kq)("v-if",!0)],2)]),(0,c.wy)((0,c._)("div",De,[b.mess_string?((0,c.wg)(),(0,c.iD)("div",Ie,[(0,c._)("pre",null,(0,f.zw)(b.mess_string.join("\n")),1)])):(0,c.kq)("v-if",!0),b.isExpSupported?((0,c.wg)(),(0,c.iD)("div",Ue,[(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f3f836bd070c74815ead362a8f487454398863219300defba95616b4a05d5ba4d"))+(0,f.zw)(b.vulnExpValue),1),(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f6cbef27a85bc3f8936d88dc5e05aaf56"))+(0,f.zw)(b.vulnExpValue),1),(0,c._)("span",null,(0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3ff2aa70987d179fb542a983eceb853f14"))+(0,f.zw)(b.vulnExpProof),1)])):(0,c.kq)("v-if",!0),a.isHistry&&"online"==a.source&&"assets"!=a.wrap?((0,c.wg)(),(0,c.iD)("div",Ze,[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f84baae80daefeacfd6813fe281c0ed5f"))+" ",1),(0,c.Wm)(y,{type:"link",onClick:e=>function(e){(0,r.Z)({iconType:"warning",title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3fd49bc1fa97f7041008359fd24857dd9a"),content:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f5a2e52283bbc7dbd2f866d78ef0996c96d99e1ed50e9ff01947c88add35259557e8ce8f8c21290e7b066f42d37e808f80b8ab21bb6944fbc6d9f460029ecb6a848d8e4fcf93a16535b0cb46fe519770ef087735425e0ba5664500c262be2301f"),async onOk(){console.log(e);const{correctVulApi:c}=await Promise.all([d.e(2861),d.e(8942)]).then(d.bind(d,83)),{data:f}=await c({task_id:a.paramsData.hostId||0,task_ip:a.paramsData.hostIp||"",vul_id:e.vul_id,port:e.port,type:"fix-ip"});f&&function(e){for(let a in(0,l.SU)(o)){const d=(0,l.SU)(o)[a].vuls;d.some(((a,c)=>{if(a.id===e.id)return d.splice(c,1),!1}))}}(e)}})}(b)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3fc9e5b5f461c0eddfbc5bc446db7cc56f")),1)])),_:2},1032,["onClick"]),(0,c.Uk)(" , "),(0,c.Wm)(y,{type:"link",onClick:e=>function(e){(0,r.Z)({iconType:"warning",title:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3fd49bc1fa97f7041008359fd24857dd9a"),content:i("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3f5a2e52283bbc7dbd2f866d78ef0996c96d99e1ed50e9ff01947c88add3525955d292b08b24b5fe0c0c5d1b01e7a541bed20fe73c4678fe61d4cea170fd8302fa3bf43acbee81f14382143ebb76727477"),onOk:()=>{console.log(e)}})}(b)},{default:(0,c.w5)((()=>[(0,c.Uk)((0,f.zw)(e.$t("a68595c99d93674665c126f16848190166dec0dfa5ee7e4a3e52d9492127467fb0ac5d1ad55d0d241d1bddf592baf6c0cfcc352adbc4faca1012ae69f6bbde3fbaf9d77d9b17ceccc70e00eb6fb7428b")),1)])),_:2},1032,["onClick"]),(0,c.Uk)(" ） ")])):(0,c.kq)("v-if",!0)],512),[[t.F8,u.value[`${p.port}_${p.protocol}_${b.vul_id}`]]])])))),128)):(0,c.kq)("v-if",!0)])),_:1},8,["columns","dataSource"])],64)}}});var He=d(30274),We={};We.styleTagTransform=de(),We.setAttributes=J(),We.insert=Q().bind(null,"head"),We.domAPI=R(),We.insertStyleElement=ee(),B()(He.Z,We),He.Z&&He.Z.locals&&He.Z.locals;const qe=(0,te.Z)(Se,[["__scopeId","data-v-4e2deb85"]]),Pe={class:"vulnOverview"},Ee=(0,c.aZ)({__name:"VulnOverview",props:{paramsData:{},taskType:{},source:{},exportTypeTemplate:{},wrap:{}},setup(e){const a=e,{t:d}=ye.i18n.global;return(e,d)=>((0,c.wg)(),(0,c.iD)("div",Pe,[["vul_task","vul_config","guess_task"].includes(a.taskType)?((0,c.wg)(),(0,c.j4)(le,{key:0,paramsData:a.paramsData,source:a.source,wrap:a.wrap,exportTypeTemplate:a.exportTypeTemplate},null,8,["paramsData","source","wrap","exportTypeTemplate"])):"image_task"==a.taskType?((0,c.wg)(),(0,c.j4)(ke,{key:1,paramsData:a.paramsData,source:a.source,exportTypeTemplate:a.exportTypeTemplate,wrap:a.wrap},null,8,["paramsData","source","exportTypeTemplate","wrap"])):"web_scan"==a.taskType?((0,c.wg)(),(0,c.j4)(ge.default,{key:2,paramsData:a.paramsData,source:a.source,exportTypeTemplate:a.exportTypeTemplate},null,8,["paramsData","source","exportTypeTemplate"])):"assets"==a.taskType?((0,c.wg)(),(0,c.j4)(qe,{key:3,paramsData:a.paramsData,source:a.source,exportTypeTemplate:a.exportTypeTemplate,isHistry:!1,wrap:a.taskType},null,8,["paramsData","source","exportTypeTemplate","wrap"])):(0,c.kq)("v-if",!0)]))}});var Ae=d(3145),je={};je.styleTagTransform=de(),je.setAttributes=J(),je.insert=Q().bind(null,"head"),je.domAPI=R(),je.insertStyleElement=ee(),B()(Ae.Z,je),Ae.Z&&Ae.Z.locals&&Ae.Z.locals;const Fe=(0,te.Z)(Ee,[["__scopeId","data-v-0acf9326"]])}}]);